version: '3.8'

services:
  # Development version with hot reload
  hrms-frontend-dev:
    build:
      context: ..
      dockerfile: docker/Dockerfile.dev
    container_name: hrms-frontend-dev
    ports:
      - "5555:5173"
    environment:
      - VITE_SUPABASE_URL=${VITE_SUPABASE_URL}
      - VITE_SUPABASE_ANON_KEY=${VITE_SUPABASE_ANON_KEY}
      - VITE_AZURE_CLIENT_ID=${VITE_AZURE_CLIENT_ID}
      - VITE_AZURE_TENANT_ID=${VITE_AZURE_TENANT_ID}
      - VITE_AZURE_REDIRECT_URI=${VITE_AZURE_REDIRECT_URI:-http://localhost:5555}
      - VITE_API_BASE_URL=${VITE_API_BASE_URL:-http://localhost:5555/api}
      - NODE_ENV=development
    volumes:
      - ../src:/app/src:ro
      - ../public:/app/public:ro
      - ../package.json:/app/package.json:ro
      - ../vite.config.ts:/app/vite.config.ts:ro
      - ../tsconfig.json:/app/tsconfig.json:ro
      - ../tailwind.config.js:/app/tailwind.config.js:ro
    restart: unless-stopped
    networks:
      - hrms-network

  # PostgreSQL for development
  postgres-dev:
    extends:
      file: docker-compose.yml
      service: postgres
    container_name: hrms-postgres-dev
    ports:
      - "5433:5432"

networks:
  hrms-network:
    driver: bridge
